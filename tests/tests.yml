
# Annotation
- job: tools/annotation/viral_annotation_input.yml
  tool: ../CWL/Tools/Annotation/viral_annotation_swf.cwl
  short_name: viral_annotation_swf.cwl
  doc: "Viral annotation"
  output:
    annotation_tables:
      - class: File
        basename: high_confidence_putative_viral_contigs_prodigal_prot_ann_table.tsv
        checksum: sha1$e7b28fdae52358fc900616156587212878d4c1e5
        location: Any
        path: Any
        size: 1568
      - class: File
        basename: low_confidence_putative_viral_contigs_prodigal_prot_ann_table.tsv
        checksum: sha1$e7b28fdae52358fc900616156587212878d4c1e5
        location: Any
        path: Any
        size: 1568
      - class: File
        basename: putative_prophages_prodigal_prot_ann_table.tsv
        checksum: sha1$e7b28fdae52358fc900616156587212878d4c1e5
        location: Any
        path: Any
        size: 1568


# Assign
- job: tools/assign/assign_test_input.yml
  tool: ../CWL/Tools/Assign/assign_swf.cwl
  short_name: assign_swf.cwl
  doc: "Assign"
  output: &assign
    assign_tables:
      - class: File
        basename: high_confidence_putative_viral_contigs_prodigal_prot_ann_table_tax_assign.tsv
        # doesn't guarantee order.
        checksum: Any
        location: Any
        path: Any
        size: 554
      - class: File
        basename: low_confidence_putative_viral_contigs_prodigal_prot_ann_table_tax_assign.tsv
        # doesn't guarantee order.
        checksum: Any
        location: Any
        path: Any
        size: 425

# HMMScan
- job: tools/hmmscan/hmmscan_test_input.yml
  tool: ../CWL/Tools/HMMScan/hmmscan_swf.cwl
  short_name: hmmscan_swf.cwl
  doc: "HMMScan"
  output:
    output_table: &hmmscan
      class: File 
      basename: hmmer_table.tsv
      checksum: Any
      location: Any
      path: Any
      size: Any

# Length Filtering
- job: tools/length_filtering/length_filtering_test_input.yml
  tool: ../CWL/Tools/LengthFiltering/length_filtering.cwl
  short_name: length_filtering.cwl
  doc: Filter multi-fasta by length
  output:
    filtered_contigs_fasta: &lf
      class: File
      basename: ERR575691_host_filtered_filt500bp.fasta
      checksum: sha1$d15b69ff3be57c036f8c4585d21855b4bc686c56
      location: Any
      path: Any
      size: 2212936

# Parse
- job: tools/parse/parse_test_input.yml
  tool: ../CWL/Tools/ParsingPredictions/parse_viral_pred.cwl
  short_name: parse_viral_pred.cwl
  doc: Parse viral predictions
  output: &parse
    high_confidence_contigs: null
    prophages_contigs: null
    low_confidence_contigs:
        basename: low_confidence_putative_viral_contigs.fna
        checksum: Any
        class: File
        location: Any
        path: Any
        size: 124813
    stderr:
        basename: stderr.txt
        checksum: Any
        class: File
        location: Any
        path: Any
        size: 0
    stdout:
        basename: stdout.txt
        checksum: Any
        class: File
        location: Any
        path: Any
        size: 102

# Prodigal
- job: tools/prodigal/prodigal_test_input.yml
  tool: ../CWL/Tools/Prodigal/prodigal.cwl
  short_name: prodigal.cwl
  doc: Prodigal
  output: &prodigal
    output_fasta:
      class: File
      basename: high_confidence_putative_viral_contigs_prodigal.faa
      location: Any
      path: Any
      checksum: sha1$4cff8f3da5e1487b84d7d9206dc1bdba54854133
      size: 256490
    stderr:
      class: File
      basename: stderr.txt
      location: Any
      path: Any
      checksum: sha1$58cac28b782429a51dcdea296a61d4489ae3d087
      size: 596
    stdout:
      class: File
      basename: stdout.txt
      location: Any
      path: Any
      checksum: sha1$347740ecee42d2913409f4c89a7a2635cca03dc3
      size: 160778

# Ratio evalue
- job: tools/ratio_evalue/ratio_evalue_test_input.yml
  tool: ../CWL/Tools/RatioEvalue/ratio_evalue.cwl
  short_name: ratio_evalue.cwl
  doc: RatioEvalue
  output:
    informative_table:
      class: File
      basename: hmmer_ViPhOG_modified_informative.tsv
      location: Any
      path: Any
      size: 292
    stderr:
      class: File
      basename: stderr.txt
      location: Any
      path: Any
      checksum: sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709
      size: 0
    stdout:
      class: File
      basename: stdout.txt
      location: Any
      path: Any
      checksum: sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709
      size: 0

# VirFinder 
- job: tools/virfinder/virfinder_test_input.yml
  tool: ../CWL/Tools/VirFinder/virfinder.cwl
  short_name: virfinder.cwl
  doc: VirFinder
  output:
    virfinder_output:
      class: File
      basename: virfinder_output.tsv
      location: Any
      path: Any
      checksum: sha1$8a81b6d8c4876c8d91d16dd82c6f2fc26e50cc41
      size: 104

# VirSorter
- job: tools/virsorter/virsorter_test_input.yml
  tool: ../CWL/Tools/VirSorter/virsorter.cwl
  short_name: virsorter.cwl
  doc: VirSorter
  output:
      predicted_viral_seq_dir:
        basename: Predicted_viral_sequences
        class: Directory
        location: Predicted_viral_sequences
        path: Predicted_viral_sequences
        listing: &virsorter
          - class: File
            basename: VIRSorter_cat-1.fasta
            checksum: Any
            location: Any
            path: Any  
            size: 5448
          - class: File
            basename: VIRSorter_cat-2.fasta
            checksum: Any
            size: 37434
            location: Any
            path: Any    
          - class: File
            basename: VIRSorter_cat-3.fasta
            checksum: sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709
            size: 0
            location: Any
            path: Any    
          - class: File
            basename: VIRSorter_prophages_cat-4.fasta
            checksum: Any
            size: 0
            location: Any
            path: Any    
          - class: File
            basename: VIRSorter_prophages_cat-5.fasta
            checksum: Any
            size: 0
            location: Any
            path: Any    
          - class: File
            basename: VIRSorter_prophages_cat-6.fasta
            checksum: sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709
            size: 0
            path: Any
            location: Any
          - class: File
            basename: VIRSorter_cat-1.gb
            checksum: Any
            size: 13292
            location: Any
            path: Any    
          - class: File
            basename: VIRSorter_cat-2.gb
            checksum: Any
            location: Any
            path: Any
            size: 87306
          - class: File
            basename: VIRSorter_cat-3.gb
            checksum: Any
            size: 0
            location: Any
            path: Any
          - class: File
            basename: VIRSorter_prophages_cat-4.gb
            location: Any
            path: Any
            checksum: Any
            size: 0
          - class: File
            basename: VIRSorter_prophages_cat-5.gb
            checksum: Any
            size: 0
            location: Any
            path: Any    
          - class: File
            basename: VIRSorter_prophages_cat-6.gb
            checksum: sha1$da39a3ee5e6b4b0d3255bfef95601890afd80709
            size: 0
            location: Any
            path: Any    
      stderr:
        class: File
        basename: stderr.txt
        checksum: sha1$d189933ff267892f43370dcd046e36e2375071eb
        location: Any
        path: Any
        size: 158
      stdout:
        class: File
        basename: stdout.txt
        checksum: Any
        location: Any
        path: Any
        size: Any

# Krona
- job: tools/krona/krona_test_input.yml
  tool: ../CWL/Tools/Krona/krona_swf.cwl
  short_name: krona.cwl
  doc: Krona subworkflow
  output:
    krona_all_html:
      basename: krona_all_krona.html
      checksum: Any
      class: File
      format: https://www.iana.org/assignments/media-types/text/html
      location: Any
      path: Any
      size: 229001
    krona_htmls:
    - basename: test_tax_assign_1_tax_counts_krona.html
      checksum: Any
      class: File
      format: https://www.iana.org/assignments/media-types/text/html
      location: Any
      path: Any
      size: 226917
    - basename: test_tax_assign_2_tax_counts_krona.html
      checksum: Any
      class: File
      format: https://www.iana.org/assignments/media-types/text/html
      location: Any
      path: Any
      size: 228280
    - basename: test_tax_assign_3_tax_counts_krona.html
      checksum: Any
      class: File
      format: https://www.iana.org/assignments/media-types/text/html
      location: Any
      path: Any
      size: 227243
    table_all:
      basename: krona_all.tsv
      checksum: Any
      class: File
      location: Any
      path: Any
      size: 912
    tables:
    - basename: test_tax_assign_1_tax_counts.tsv
      checksum: Any
      class: File
      location: Any
      path: Any
      size: 152
    - basename: test_tax_assign_2_tax_counts.tsv
      checksum: Any
      class: File
      location: Any
      path: Any
      size: 546
    - basename: test_tax_assign_3_tax_counts.tsv
      checksum: Any
      class: File
      location: Any
      path: Any
      size: 214


## -- Workflows -- ##
# TODO: Too slow, enable after VirSorter fasta chunking
# Pipeline
- job: workflows/pipeline_test_input.yml
  tool: ../CWL/pipeline.cwl
  short_name: pipeline.cwl
  doc: "Workflow"
  output:
      output_length_filtering: *lf
      output_parse: *parse
      output_prodigal: *prodigal
      output_final_assign: *assign
      output_virsorter: *virsorter
      # output_krona_html: *krona